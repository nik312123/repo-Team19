# Java Gradle CircleCI 2.1 configuration file
#
# Check https://circleci.com/docs/2.0/language-java/ for more details
#
version: 2.1
jobs:
    build:
        machine:
            # Machine that already has JDK 11 (or higher) and ant 1.10.x (or higher) installed
            image: ubuntu-2004:202101-01
        steps:
            # Checks out the repo
            - checkout
            
            # Build the project
            - run: ant
            
            # Run the JUnit tests and ensure they pass
            - run: java -jar lib/junit-platform-console-standalone-1.8.0-M1.jar -cp out/production/repo-Team19:out/test/repo-Team19 -p org.team19
            
            # Test that the JUnit tests did not produce any additional files in the Project2/testing/test-resources directory
            - run: if Project2/misc/test_no_files_generated.sh; then echo "No files were generated by tests that were not cleaned up ✅"; else echo "Files were generated by tests that were not cleaned up ❌"; fi
